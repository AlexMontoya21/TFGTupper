<script type="text/javascript" src="js/ValidacionFormulario.js"></script>
<script src="../js/jquery-2.1.4.min.js" type="text/javascript"></script>
<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 " id="zona_usuario">
    <div class="mensaje">{mensaje}</div>
    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 contenido_info_usuario">
        <div style="float:left;height: 1px;width:80px;">

            <div class="foto_usuario" style="background-image: url('img/platos/{foto}')">

                <div class="gorro"></div>
            </div>
        </div>
        <div class="info_usuario">

            <h1>{nombre} {apellidos}</h1>
            <h3>{email}</h3>
            <p>{poblacion}</p>
            <p>{edad} años</p>
            <input type="button" value="Editar Perfil" class="editar">
            <input type="button" value="Subir Tupper" class="editar">
        </div>


    </div>
    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" style="padding: 0">
        <div class='formulario'>
            <div class="advertencia"></div>
            <form id="register-form" action="" method="post" role="form">
                <div class="form-group">
                    <label>Nombre de Usuario</label>   <input type="text" name="username" id="username"  oninput="obligatorio()" required tabindex="1" class="form-control" placeholder="Username" >
                </div>
                <p id="musuario" class="hidden">Nombre no valido</p>
                <div class="form-group">
                    <label>DNI</label>    <input type="text" name="dni" id="dni" tabindex="1" class="form-control" placeholder="DNI" value="" oninput="obligatorio()" required>
                </div>
                <div id="mdni" >DNI no valido</div>
                <div class="form-group">
                    <label>Telefono</label>   <input type="text" name="telefono" id="telefono" tabindex="1" class="form-control" placeholder="Telefono" value="" oninput="obligatorio()" required>
                </div>
                <p id="mtelefono" class="hidden">Telefono no valido</p>
                <div class="form-group">
                    <label>Email</label>    <input type="email" name="email" id="email" tabindex="1" class="form-control" placeholder="Email Address" value="" oninput="obligatorio()" required>
                </div>
                <p id="memail" class="hidden">Email no valido</p>
                <div class="form-group">
                    <label>Contraseña</label>    <input type="password" name="password" id="password" tabindex="1" class="form-control" placeholder="Password" oninput="obligatorio()" required>
                </div>
                <div class="form-group">
                    <label>Repetir contraseña</label>   <input type="password" name="confirm-password" id="confirm-password" tabindex="1" class="form-control" placeholder="Confirm Password">
                </div>


                <div class="form-group">
                    <div class="row">
                        <div class="col-sm-6 col-sm-offset-3">
                            <input type="submit" name="Enviar" id="Enviar" tabindex="4" class="form-control btn btn-register" value="Registrar ahora" disabled onclick="validaTodos()">
                        </div>
                    </div>
                </div>
            </form>

            <form id='subir_tupper' method="post" enctype="multipart/form-data" onsubmit="return subir_tupper1()" action="subirtupper.php"><table  style=" width: 100%">
                    <tr >
                        <td>       
                            <label for="nombre_tupper">Nombre</label>
                        </td>
                        <td>
                            <input type="text" name="nombre_tupper" id="nombre_tupper" maxlength="30"> <br>
                            <span class="sugerencia">(maximo 30 caracteres)</span>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:120px;"> 
                            <label for="imagen_tupper">Foto del Tupper </label>
                        </td>
                        <td> 
                            <input type="file" name="imagen_tupper" id='foto_tupper'> 
                        </td>
                    </tr>
                    <tr>
                        <td> 
                            <label for="tipo_tupper">Sobre el tupper</label>
                        </td>
                        <td> 
                            <select id="tipo_tupper" name="tipo_tupper">
                                <option >tipo</option>
                                <option>carne</option>
                                <option>pescado</option>
                                <option>arroz</option>
                                <option>verduras</option>
                                <option>entrantes</option>
                                <option>pucheros</option>
                                <option >postres</option>
                                <option>pasta</option>
                            </select> 

                            <input type="checkbox" name="vegano_tupper">Vegano
                            <input type="checkbox" name="vegetariano_tupper">Vegetariano
                            <input type="checkbox" name="sin_gluten_tupper">Sin Gluten
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2"> 
                            <label for="descripcion_tupper">Descripcion</label>
                            <textarea id="descripcion_tupper" name="descripcion_tupper"></textarea>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2" style="padding-top: 15px;"> 
                            <input type="submit" name="subir_tupper" onclick="subir_tupper1()">
                        </td>
                    </tr>
                </table>
            </form>




        </div>


    </div>
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 contenido">

        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 bloque">
            <h2 id="notificaciones"><span class="glyphicon glyphicon-bell"></span> Notificaciones <span class="c_n">{c_n}</span></h2>
            <div id="notificaciones_c">{notificaciones}</div>
        </div>
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 bloque ">
            <h2 id="tuppers_adquiridos"><span class="glyphicon glyphicon-heart"></span> Tuppers Pedidos <span class="c_ta">{c_ta}</span></h2>
            <div id="tuppers_adquiridos_c">{tuppers_adquiridos}</div></div>
        </div>
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 bloque">
            <h2 id="mis_tuppers"><span class="glyphicon glyphicon-folder-close"></span> Mis Tuppers <span class="c_mt">{c_mt}</span></h2>
            <div id="mis_tuppers_c">{mis_tuppers}</div>
        </div>
    </div>

<script type="text/javascript">
    $('.ver span').click(function () {
        var altura = $(this).parent().prev().outerHeight();
        if (altura == 20) {
            $(this).parent().prev().css('height', $(this).parent().prev().children().outerHeight() + 5);
            $(this).html('ver menos');
        }
        else {
            $(this).parent().prev().css('height', '0px');
            $(this).html('ver mas');
        }

    });
    $('div.info_usuario h1').click(function () {
        var tamaño = $('div.info_usuario h1').css('font-size');
        $('#zona_usuario .contenido_info_usuario.ampliado .editar').removeClass('selected');
        if (tamaño == '34px') {
            $('.contenido_info_usuario').addClass('ampliado');
        }
        else {
            $('.contenido_info_usuario').removeClass('ampliado');
            $('.formulario').css('height', '');
            $('.formulario').removeClass('ampliado');

        }
    });


    $('.editar').click(function () {
        if ($(this)[0].value == 'Subir Tupper') {
            $('.formulario #subir_tupper').delay(200).fadeIn(200);
            $('.formulario #register-form').fadeOut(100);
        }
        else {

            $('.formulario #register-form').delay(200).fadeIn(200);
            $('.formulario #subir_tupper').fadeOut(100);
        }
        if (parseInt($('.formulario').css('height')) >= 395 && $(this).hasClass('selected')) {
            $('.formulario').css('height', '');
            $('.formulario').removeClass('ampliado');
            $(this).removeClass('selected');
        }
        else {
            $('.formulario').addClass('ampliado');
            setTimeout(function () {
                $('.formulario').css('height', 'auto');
            }, 600);
            $('#zona_usuario .contenido_info_usuario.ampliado .editar').removeClass('selected');
            $(this).addClass('selected');
        }

    });

    $('input.notifi.ed_tupper').click(function () {
        var contenido = $(this).parent().prev();
        var titulo = (contenido.children('h3')[0].innerHTML).substr(0, contenido.children('h3')[0].innerHTML.indexOf('<span'));
        contenido.children('h3').empty();
        contenido.children('h3').html('<input type="text" value="' + titulo + '" id="nombre" name="nombre">');
        contenido.children('h3').after('<input type="file" id="foto" name="foto">');
        var descripcion = (contenido.children('.descripcion')[0].innerHTML);
        contenido.children('.descripcion').css('height','auto');
        contenido.children('.descripcion').empty();
        contenido.children('.descripcion').html('<textarea>'+descripcion+'</textarea>');
        var checkboxs=' <input type="checkbox" name="vegano_tupper">Vegano <input type="checkbox" name="vegetariano_tupper">Vegetariano<input type="checkbox" name="sin_gluten_tupper">Sin Gluten';
  
        for(var i=0; i<contenido.children('.gestion').children().length;i++){
        var reemplazo=contenido.children('.gestion').children()[i].className+'_tupper"';
        checkboxs=checkboxs.replace(reemplazo, reemplazo+'" checked');
        }        
        contenido.children('.ver').css('display','none');
        contenido.children('.gestion').empty();        
        var select='<select id="tipo_tupper" name="tipo_tupper"><option>carne</option><option>pescado</option><option>arroz</option><option>verduras</option><option>entrantes</option><option>pucheros</option><option>postres</option><option>pasta</option></select>';
        select=select.replace(">"+(contenido.children('#tipo')[0].value), " selected>"+(contenido.children('#tipo')[0].value));
        contenido.children('.gestion').html(select+checkboxs);
        contenido.next().empty();
        var aceptar="<input type='submit' class='notifi' value='Aceptar'>";
        var cancelar="<input type='button' class='notifi naranja' value='Cancelar' onclick='location.reload()'>";
        contenido.next().html(aceptar+cancelar);
        contenido.parent().wrap('<form id="ed_tupper"  method="post" enctype="multipart/form-data" action="editarTupper.php"></form>');
        
        tinymce.init({
        selector: "textarea",
        theme: "modern",
        plugins: [
            "wordcount", "hr",
        ],
        toolbar1: "undo redo | formatselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | hr",
    });
    $('#mceu_49').css('display','none');
    })



    tinymce.init({
        selector: "textarea",
        theme: "modern",
        plugins: [
            "wordcount", "hr",
        ],
        toolbar1: "undo redo | formatselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | hr",
    });

</script>